sap.ui.define(["sap/m/MessageToast","sap/m/Dialog","sap/m/Button","sap/m/Text","sap/m/MessageBox","sap/ui/model/json/JSONModel","sap/ui/core/BusyIndicator"],function(e,t,n,s,o,i,a){"use strict";return{SendQuotation:async function(o){debugger;a.show(0);let i=[];var r="",u="";var c=true;const g=this._view;const l=g.getContent()[0];const d=l.getAggregation("footer");var m=this._view.byId("sales::PurchaseEnquiryObjectPage--fe::CustomSubSection::Comments--_IDGenTextArea");var f="";const h=g.getContent()[0].mAggregations.sections[5].mForwardedAggregations.subSections[0].mAggregations._grid.mAggregations.content[0].mAggregations.content.mAggregations.items[1];const p=h.getValue();var w=o.sPath;const b=/purchaseEnquiryUuid=([a-fA-F0-9-]+)/;const y=w.match(b);let x="quotationFun";let v=o.getModel().bindContext(`/${x}(...)`);var C="check";v.setParameter("peUuid",y[1]);v.setParameter("value",C);await v.execute();const P=v.getBoundContext();debugger;const A=P.getValue();if(A&&A.value==="empty enquiry fields"){c=false;i.push("Enquiry Details are missing.")}if(A&&A.value==="empty Plant Data"){i.push("Plant Details are missing.")}const q=/^[^a-zA-Z0-9]+$/;if(!p){i.push("Comment is missing.")}if(q.test(p)){i.push("Comments cannot consist solely of special characters.")}const B=i.join("\n");if(B.length>0){var E=new t({title:"Error",type:"Message",state:"Error",content:new s({text:`${B}\nPlease complete all required fields.`}),beginButton:new n({text:"OK",press:function(){E.close();a.hide()}})});E.open();return}else{var U=new t({title:"Confirmation",type:"Message",content:new s({text:"Do you want to send Quotiation?\nBefore sending, Please Confirm"}),beginButton:new n({text:"Confirm",press:async function(){try{U.close();a.show(0);const n=window.location.href;const s=/purchaseEnquiryUuid=([a-f0-9\-]+)/;const i=n.match(s);let r;if(i&&i[1]){r=i[1]}else{a.hide();console.log("UUID not found");e.show("Purchase Enquiry UUID not found.");return}let u="commentsFun";let c=o.getModel().bindContext(`/${u}(...)`);c.setParameter("commentsText",p).setParameter("peUuid",r);await c.execute();debugger;let l="quotationFun";let f=o.getModel().bindContext(`/${l}(...)`);var t="send";f.setParameter("peUuid",r);f.setParameter("value",t);await f.execute();const h=f.getBoundContext();debugger;const w=h.getValue();console.log(w);e.show("Quotation  Sent Successfully!");setTimeout(function(){debugger;m.setValue("");debugger}.bind(this),800);const b=g.findAggregatedObjects(true,function(e){return e.isA("sap.m.Button")&&(e.getId().includes("Edit")||e.getId().includes("send"))});b[0].setVisible(false);b[1].setVisible(false);d.setVisible(false);a.hide()}catch(t){a.hide();e.show("Error while processing request")}}}),endButton:new n({text:"Cancel",press:function(){U.close()}})})}a.show(0);U.open();a.hide()}}});
//# sourceMappingURL=SendQuotation.js.map